<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Inventory Management</title>

<style>
body {margin:0;font-family:"Segoe UI",Roboto;background:#f5f6f7;}
.header {height:56px;background:#0b5cab;color:#fff;display:flex;align-items:center;padding:0 20px;font-weight:600;}
.container {display:flex;height:calc(100vh - 56px);}
.sidebar {width:240px;background:#1f2937;color:#d1d5db;}
.sidebar a {display:block;padding:12px 20px;color:#d1d5db;text-decoration:none;}
.sidebar a:hover {background:#374151;}
.main {flex:1;padding:20px;overflow:auto;}
.card {background:#fff;padding:20px;border-radius:6px;box-shadow:0 1px 3px rgba(0,0,0,.1);}
button {background:#0b5cab;color:#fff;border:none;padding:8px 14px;border-radius:4px;cursor:pointer;}
button.secondary {background:#6b7280;}
table {width:100%;border-collapse:collapse;margin-top:15px;}
th,td {padding:10px;border-bottom:1px solid #e5e7eb;}
th {background:#f9fafb;}
.modal {position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;}
.modal-content {background:#fff;padding:20px;width:420px;border-radius:6px;}
input,select {width:100%;padding:8px;margin:6px 0;border:1px solid #d1d5db;border-radius:4px;}
</style>
</head>

<body>

<div class="header">Inventory Management</div>

<div class="container">
  <div class="sidebar">
    <a onclick="showInventory()">Products</a>
    <a onclick="showReports()">Reports</a>
  </div>
  <div class="main" id="content"></div>
</div>

<!-- CREATE ITEM -->
<div class="modal" id="modal">
  <div class="modal-content">
    <h3>Create Item</h3>
    <input id="name" placeholder="Item Name">
    <input id="sku" placeholder="SKU">
    <input id="cost" type="number" placeholder="Cost">
    <input id="qty" type="number" placeholder="Quantity">
    <button onclick="addItem()">Create</button>
    <button class="secondary" onclick="closeModal()">Cancel</button>
  </div>
</div>

<script>
let inventory = JSON.parse(localStorage.inventory||"[]");
let audit = JSON.parse(localStorage.audit||"[]");

function log(action,item){
  audit.push({time:new Date().toLocaleString(),action,item});
  localStorage.audit = JSON.stringify(audit);
}

function showInventory(){
  content.innerHTML = `
  <div class="card">
    <h2>Products Dashboard</h2>
    <button onclick="openModal()">➕ Create Item</button>
    <button class="secondary" onclick="exportCSV('inventory')">Export CSV</button>
    <table>
      <tr><th>Name</th><th>SKU</th><th>Qty</th><th>Cost</th><th>Value</th></tr>
      ${inventory.map((i,n)=>`
      <tr onclick="openRecord(${n})">
        <td>${i.name}</td>
        <td>${i.sku}</td>
        <td>${i.qty}</td>
        <td>$${i.cost}</td>
        <td>$${(i.qty*i.cost).toFixed(2)}</td>
      </tr>`).join("")}
    </table>
  </div>`;
}

function openRecord(i){
  const p = inventory[i];
  content.innerHTML = `
  <div class="card">
    <h2>${p.name} (Record)</h2>
    <p><b>SKU:</b> ${p.sku}</p>
    <p><b>Quantity:</b> ${p.qty}</p>
    <p><b>Cost:</b> $${p.cost}</p>
    <p><b>Total Value:</b> $${(p.qty*p.cost).toFixed(2)}</p>
    <h3>Audit History</h3>
    ${audit.filter(a=>a.item===p.name).map(a=>`<div>${a.time} — ${a.action}</div>`).join("")}
    <br>
    <button onclick="showInventory()">Back</button>
  </div>`;
}

function showReports(){
  content.innerHTML = `
  <div class="card">
    <h2>Reports & Audit</h2>
    <button onclick="exportCSV('audit')">Export Audit CSV</button>
    <p><b>Total Inventory Value:</b> $${inventory.reduce((s,i)=>s+i.qty*i.cost,0).toFixed(2)}</p>
  </div>`;
}

function exportCSV(type){
  let rows = type==="inventory"
    ? [["Name","SKU","Qty","Cost"],...inventory.map(i=>[i.name,i.sku,i.qty,i.cost])]
    : [["Time","Action","Item"],...audit.map(a=>[a.time,a.action,a.item])];

  let csv = rows.map(r=>r.join(",")).join("\\n");
  let a = document.createElement("a");
  a.href = URL.createObjectURL(new Blob([csv]));
  a.download = type+".csv";
  a.click();
}

function openModal(){modal.style.display="flex";}
function closeModal(){modal.style.display="none";}

function addItem(){
  inventory.push({name:name.value,sku:sku.value,cost:+cost.value,qty:+qty.value});
  log("CREATE ITEM",name.value);
  localStorage.inventory = JSON.stringify(inventory);
  closeModal();showInventory();
}

showInventory();
</script>

</body>
</html>
